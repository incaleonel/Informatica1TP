
##########################
# Compiler and arguments #
##########################

CC = gcc
C_PARAM = -c -g
LD= -lm

##########################
#   Src, Obj and Exec    #
##########################

SRC= $(wildcard *.c)
OBJ= $(SRC:.c=.o)
HEAD= $(wildcard *.h)
Exec= server


##########################
#     Documentation      #
##########################

DOC_GEN= doxygen
DOC_FILE= Doxyfile
DOC_LINE= $(DOC_GEN) $(DOC_FILE)

##########################
#        Compress        #
##########################

OTHER_FILES= Makefile $(DOC_FILE)
FILE_OUT= $(Author)-$(Curse)-$(TP).tar.gz
COMPRESS_LINE= tar -zcvf $(FILE_OUT) $(SRC) $(HEAD) $(OTHER_FILES)

######################################################################################################
######################################################################################################

all: linker
linker: compiler
	@echo "\n===================================================================================="
	@echo "  Linking" $(OBJ)    
	@echo "===================================================================================="
	$(CC) -o $(Exec) $(OBJ) $(LD)
	@echo "\n===================================================================================="
	@echo "  Finish: OK\n\n"

compiler:$(OBJ)
%.o: %.c
	@echo "\n===================================================================================="
	@echo "  Compiling the file: " $< 
	@echo "===================================================================================="
	$(CC) $(C_PARAM) $< -o $@ 

clean:
	@echo "\n===================================================================================="
	@echo "  Cleaning: " $(OBJ) $(Exec) 
	@echo "===================================================================================="
	rm $(OBJ) $(Exec)
	@echo "\n"

compress:
	@echo "\n===================================================================================="
	@echo "  Compressing "
	@echo "===================================================================================="
	@$(COMPRESS_LINE)	
	@echo "\n===================================================================================="
	@echo  $(FILE_OUT)": OK\n\n"

help:
	@echo "\n===================================================================================="
	@echo "  Help: "
	@echo "    all: Compile and Linker"
	@echo "    file.o: Compile the file.c"
	@echo "    clean: remove generated files"
	@echo "    doxy: makes the documentation"
	@echo "====================================================================================\n"

doc:
	@echo "\n===================================================================================="
	@echo "  Making the documentation " 
	@echo "===================================================================================="
	$(DOC_LINE)
	@echo "\n===================================================================================="
	@echo "  Documentation: OK\n\n"
	
